D:\ProgramData\Anaconda3\envs\myenvs\python.exe E:/machine_learning/recurrent_nerual_network/rnnlm.py
------------------------------------------------------------
                       GPU Mode (cupy)
------------------------------------------------------------

| epoch 1 |  iter 1 / 1327 | time 3[s] | perplexity 10000.11
| epoch 1 |  iter 21 / 1327 | time 6[s] | perplexity 2884.28
| epoch 1 |  iter 41 / 1327 | time 8[s] | perplexity 1236.10
| epoch 1 |  iter 61 / 1327 | time 11[s] | perplexity 956.98
| epoch 1 |  iter 81 / 1327 | time 14[s] | perplexity 789.18
| epoch 1 |  iter 101 / 1327 | time 16[s] | perplexity 631.64
| epoch 1 |  iter 121 / 1327 | time 18[s] | perplexity 629.41
| epoch 1 |  iter 141 / 1327 | time 21[s] | perplexity 590.59
| epoch 1 |  iter 161 / 1327 | time 23[s] | perplexity 560.34
| epoch 1 |  iter 181 / 1327 | time 26[s] | perplexity 587.34
| epoch 1 |  iter 201 / 1327 | time 28[s] | perplexity 491.82
| epoch 1 |  iter 221 / 1327 | time 31[s] | perplexity 481.71
| epoch 1 |  iter 241 / 1327 | time 33[s] | perplexity 434.45
| epoch 1 |  iter 261 / 1327 | time 36[s] | perplexity 461.59
| epoch 1 |  iter 281 / 1327 | time 38[s] | perplexity 448.21
| epoch 1 |  iter 301 / 1327 | time 41[s] | perplexity 389.30
| epoch 1 |  iter 321 / 1327 | time 44[s] | perplexity 342.01
| epoch 1 |  iter 341 / 1327 | time 46[s] | perplexity 403.14
| epoch 1 |  iter 361 / 1327 | time 49[s] | perplexity 405.99
| epoch 1 |  iter 381 / 1327 | time 51[s] | perplexity 333.09
| epoch 1 |  iter 401 / 1327 | time 54[s] | perplexity 351.26
| epoch 1 |  iter 421 / 1327 | time 56[s] | perplexity 349.48
| epoch 1 |  iter 441 / 1327 | time 59[s] | perplexity 335.79
| epoch 1 |  iter 461 / 1327 | time 62[s] | perplexity 333.81
| epoch 1 |  iter 481 / 1327 | time 64[s] | perplexity 308.07
| epoch 1 |  iter 501 / 1327 | time 67[s] | perplexity 312.67
| epoch 1 |  iter 521 / 1327 | time 70[s] | perplexity 299.68
| epoch 1 |  iter 541 / 1327 | time 72[s] | perplexity 323.44
| epoch 1 |  iter 561 / 1327 | time 75[s] | perplexity 288.22
| epoch 1 |  iter 581 / 1327 | time 77[s] | perplexity 260.04
| epoch 1 |  iter 601 / 1327 | time 80[s] | perplexity 339.72
| epoch 1 |  iter 621 / 1327 | time 82[s] | perplexity 313.17
| epoch 1 |  iter 641 / 1327 | time 85[s] | perplexity 286.20
| epoch 1 |  iter 661 / 1327 | time 88[s] | perplexity 272.28
| epoch 1 |  iter 681 / 1327 | time 90[s] | perplexity 232.19
| epoch 1 |  iter 701 / 1327 | time 93[s] | perplexity 256.34
| epoch 1 |  iter 721 / 1327 | time 95[s] | perplexity 264.98
| epoch 1 |  iter 741 / 1327 | time 98[s] | perplexity 227.43
| epoch 1 |  iter 761 / 1327 | time 100[s] | perplexity 240.18
| epoch 1 |  iter 781 / 1327 | time 103[s] | perplexity 223.21
| epoch 1 |  iter 801 / 1327 | time 106[s] | perplexity 246.65
| epoch 1 |  iter 821 / 1327 | time 108[s] | perplexity 229.47
| epoch 1 |  iter 841 / 1327 | time 111[s] | perplexity 233.57
| epoch 1 |  iter 861 / 1327 | time 114[s] | perplexity 230.55
| epoch 1 |  iter 881 / 1327 | time 116[s] | perplexity 209.01
| epoch 1 |  iter 901 / 1327 | time 119[s] | perplexity 256.46
| epoch 1 |  iter 921 / 1327 | time 121[s] | perplexity 231.54
| epoch 1 |  iter 941 / 1327 | time 124[s] | perplexity 237.57
| epoch 1 |  iter 961 / 1327 | time 127[s] | perplexity 249.59
| epoch 1 |  iter 981 / 1327 | time 129[s] | perplexity 233.84
| epoch 1 |  iter 1001 / 1327 | time 132[s] | perplexity 198.98
| epoch 1 |  iter 1021 / 1327 | time 135[s] | perplexity 232.15
| epoch 1 |  iter 1041 / 1327 | time 137[s] | perplexity 213.31
| epoch 1 |  iter 1061 / 1327 | time 140[s] | perplexity 202.58
| epoch 1 |  iter 1081 / 1327 | time 143[s] | perplexity 174.90
| epoch 1 |  iter 1101 / 1327 | time 145[s] | perplexity 200.71
| epoch 1 |  iter 1121 / 1327 | time 148[s] | perplexity 236.43
| epoch 1 |  iter 1141 / 1327 | time 150[s] | perplexity 215.04
| epoch 1 |  iter 1161 / 1327 | time 153[s] | perplexity 205.14
| epoch 1 |  iter 1181 / 1327 | time 156[s] | perplexity 196.18
| epoch 1 |  iter 1201 / 1327 | time 158[s] | perplexity 169.09
| epoch 1 |  iter 1221 / 1327 | time 161[s] | perplexity 165.39
| epoch 1 |  iter 1241 / 1327 | time 164[s] | perplexity 194.18
| epoch 1 |  iter 1261 / 1327 | time 166[s] | perplexity 178.24
| epoch 1 |  iter 1281 / 1327 | time 169[s] | perplexity 188.10
| epoch 1 |  iter 1301 / 1327 | time 171[s] | perplexity 230.98
| epoch 1 |  iter 1321 / 1327 | time 174[s] | perplexity 218.13
| epoch 2 |  iter 1 / 1327 | time 175[s] | perplexity 232.44
| epoch 2 |  iter 21 / 1327 | time 178[s] | perplexity 211.16
| epoch 2 |  iter 41 / 1327 | time 180[s] | perplexity 197.14
| epoch 2 |  iter 61 / 1327 | time 183[s] | perplexity 183.53
| epoch 2 |  iter 81 / 1327 | time 186[s] | perplexity 166.52
| epoch 2 |  iter 101 / 1327 | time 188[s] | perplexity 160.02
| epoch 2 |  iter 121 / 1327 | time 191[s] | perplexity 167.30
| epoch 2 |  iter 141 / 1327 | time 194[s] | perplexity 185.72
| epoch 2 |  iter 161 / 1327 | time 196[s] | perplexity 198.46
| epoch 2 |  iter 181 / 1327 | time 199[s] | perplexity 206.31
| epoch 2 |  iter 201 / 1327 | time 202[s] | perplexity 194.08
| epoch 2 |  iter 221 / 1327 | time 204[s] | perplexity 190.32
| epoch 2 |  iter 241 / 1327 | time 207[s] | perplexity 183.55
| epoch 2 |  iter 261 / 1327 | time 209[s] | perplexity 190.52
| epoch 2 |  iter 281 / 1327 | time 212[s] | perplexity 193.49
| epoch 2 |  iter 301 / 1327 | time 215[s] | perplexity 171.86
| epoch 2 |  iter 321 / 1327 | time 217[s] | perplexity 143.52
| epoch 2 |  iter 341 / 1327 | time 220[s] | perplexity 179.73
| epoch 2 |  iter 361 / 1327 | time 223[s] | perplexity 205.55
| epoch 2 |  iter 381 / 1327 | time 226[s] | perplexity 160.69
| epoch 2 |  iter 401 / 1327 | time 228[s] | perplexity 175.95
| epoch 2 |  iter 421 / 1327 | time 231[s] | perplexity 164.30
| epoch 2 |  iter 441 / 1327 | time 234[s] | perplexity 169.22
| epoch 2 |  iter 461 / 1327 | time 236[s] | perplexity 164.78
| epoch 2 |  iter 481 / 1327 | time 239[s] | perplexity 163.09
| epoch 2 |  iter 501 / 1327 | time 242[s] | perplexity 178.68
| epoch 2 |  iter 521 / 1327 | time 245[s] | perplexity 178.91
| epoch 2 |  iter 541 / 1327 | time 247[s] | perplexity 180.48
| epoch 2 |  iter 561 / 1327 | time 250[s] | perplexity 161.84
| epoch 2 |  iter 581 / 1327 | time 253[s] | perplexity 146.09
| epoch 2 |  iter 601 / 1327 | time 256[s] | perplexity 197.99
| epoch 2 |  iter 621 / 1327 | time 259[s] | perplexity 189.87
| epoch 2 |  iter 641 / 1327 | time 262[s] | perplexity 172.02
| epoch 2 |  iter 661 / 1327 | time 265[s] | perplexity 162.47
| epoch 2 |  iter 681 / 1327 | time 267[s] | perplexity 135.40
| epoch 2 |  iter 701 / 1327 | time 270[s] | perplexity 157.78
| epoch 2 |  iter 721 / 1327 | time 272[s] | perplexity 165.96
| epoch 2 |  iter 741 / 1327 | time 275[s] | perplexity 141.09
| epoch 2 |  iter 761 / 1327 | time 278[s] | perplexity 136.77
| epoch 2 |  iter 781 / 1327 | time 282[s] | perplexity 141.05
| epoch 2 |  iter 801 / 1327 | time 286[s] | perplexity 155.11
| epoch 2 |  iter 821 / 1327 | time 288[s] | perplexity 151.02
| epoch 2 |  iter 841 / 1327 | time 291[s] | perplexity 151.11
| epoch 2 |  iter 861 / 1327 | time 294[s] | perplexity 153.52
| epoch 2 |  iter 881 / 1327 | time 297[s] | perplexity 136.79
| epoch 2 |  iter 901 / 1327 | time 301[s] | perplexity 172.94
| epoch 2 |  iter 921 / 1327 | time 305[s] | perplexity 154.27
| epoch 2 |  iter 941 / 1327 | time 308[s] | perplexity 161.41
| epoch 2 |  iter 961 / 1327 | time 311[s] | perplexity 170.19
| epoch 2 |  iter 981 / 1327 | time 314[s] | perplexity 160.07
| epoch 2 |  iter 1001 / 1327 | time 316[s] | perplexity 138.56
| epoch 2 |  iter 1021 / 1327 | time 320[s] | perplexity 163.20
| epoch 2 |  iter 1041 / 1327 | time 323[s] | perplexity 151.25
| epoch 2 |  iter 1061 / 1327 | time 325[s] | perplexity 134.87
| epoch 2 |  iter 1081 / 1327 | time 328[s] | perplexity 118.11
| epoch 2 |  iter 1101 / 1327 | time 332[s] | perplexity 129.21
| epoch 2 |  iter 1121 / 1327 | time 339[s] | perplexity 160.82
| epoch 2 |  iter 1141 / 1327 | time 346[s] | perplexity 149.39
| epoch 2 |  iter 1161 / 1327 | time 351[s] | perplexity 140.95
| epoch 2 |  iter 1181 / 1327 | time 355[s] | perplexity 142.75
| epoch 2 |  iter 1201 / 1327 | time 357[s] | perplexity 119.27
| epoch 2 |  iter 1221 / 1327 | time 360[s] | perplexity 116.42
| epoch 2 |  iter 1241 / 1327 | time 363[s] | perplexity 136.99
| epoch 2 |  iter 1261 / 1327 | time 366[s] | perplexity 130.08
| epoch 2 |  iter 1281 / 1327 | time 369[s] | perplexity 130.88
| epoch 2 |  iter 1301 / 1327 | time 372[s] | perplexity 167.40
| epoch 2 |  iter 1321 / 1327 | time 374[s] | perplexity 161.31
| epoch 3 |  iter 1 / 1327 | time 375[s] | perplexity 171.37
| epoch 3 |  iter 21 / 1327 | time 378[s] | perplexity 150.83
| epoch 3 |  iter 41 / 1327 | time 381[s] | perplexity 144.91
| epoch 3 |  iter 61 / 1327 | time 384[s] | perplexity 135.13
| epoch 3 |  iter 81 / 1327 | time 386[s] | perplexity 124.27
| epoch 3 |  iter 101 / 1327 | time 389[s] | perplexity 112.58
| epoch 3 |  iter 121 / 1327 | time 392[s] | perplexity 123.92
| epoch 3 |  iter 141 / 1327 | time 395[s] | perplexity 133.44
| epoch 3 |  iter 161 / 1327 | time 397[s] | perplexity 150.99
| epoch 3 |  iter 181 / 1327 | time 400[s] | perplexity 159.25
| epoch 3 |  iter 201 / 1327 | time 403[s] | perplexity 148.44
| epoch 3 |  iter 221 / 1327 | time 405[s] | perplexity 147.56
| epoch 3 |  iter 241 / 1327 | time 408[s] | perplexity 141.26
| epoch 3 |  iter 261 / 1327 | time 411[s] | perplexity 145.55
| epoch 3 |  iter 281 / 1327 | time 414[s] | perplexity 148.80
| epoch 3 |  iter 301 / 1327 | time 416[s] | perplexity 130.13
| epoch 3 |  iter 321 / 1327 | time 419[s] | perplexity 108.95
| epoch 3 |  iter 341 / 1327 | time 422[s] | perplexity 132.35
| epoch 3 |  iter 361 / 1327 | time 425[s] | perplexity 160.11
| epoch 3 |  iter 381 / 1327 | time 427[s] | perplexity 123.04
| epoch 3 |  iter 401 / 1327 | time 430[s] | perplexity 136.18
| epoch 3 |  iter 421 / 1327 | time 433[s] | perplexity 123.04
| epoch 3 |  iter 441 / 1327 | time 436[s] | perplexity 132.38
| epoch 3 |  iter 461 / 1327 | time 438[s] | perplexity 125.91
| epoch 3 |  iter 481 / 1327 | time 441[s] | perplexity 127.15
| epoch 3 |  iter 501 / 1327 | time 444[s] | perplexity 139.54
| epoch 3 |  iter 521 / 1327 | time 447[s] | perplexity 144.84
| epoch 3 |  iter 541 / 1327 | time 449[s] | perplexity 142.84
| epoch 3 |  iter 561 / 1327 | time 452[s] | perplexity 126.24
| epoch 3 |  iter 581 / 1327 | time 455[s] | perplexity 113.62
| epoch 3 |  iter 601 / 1327 | time 458[s] | perplexity 158.89
| epoch 3 |  iter 621 / 1327 | time 460[s] | perplexity 150.26
| epoch 3 |  iter 641 / 1327 | time 463[s] | perplexity 136.13
| epoch 3 |  iter 661 / 1327 | time 466[s] | perplexity 127.25
| epoch 3 |  iter 681 / 1327 | time 468[s] | perplexity 105.92
| epoch 3 |  iter 701 / 1327 | time 471[s] | perplexity 126.36
| epoch 3 |  iter 721 / 1327 | time 474[s] | perplexity 132.79
| epoch 3 |  iter 741 / 1327 | time 477[s] | perplexity 115.43
| epoch 3 |  iter 761 / 1327 | time 479[s] | perplexity 109.79
| epoch 3 |  iter 781 / 1327 | time 482[s] | perplexity 111.56
| epoch 3 |  iter 801 / 1327 | time 485[s] | perplexity 123.13
| epoch 3 |  iter 821 / 1327 | time 488[s] | perplexity 123.71
| epoch 3 |  iter 841 / 1327 | time 490[s] | perplexity 122.36
| epoch 3 |  iter 861 / 1327 | time 493[s] | perplexity 127.63
| epoch 3 |  iter 881 / 1327 | time 495[s] | perplexity 112.83
| epoch 3 |  iter 901 / 1327 | time 498[s] | perplexity 139.36
| epoch 3 |  iter 921 / 1327 | time 501[s] | perplexity 125.11
| epoch 3 |  iter 941 / 1327 | time 503[s] | perplexity 135.11
| epoch 3 |  iter 961 / 1327 | time 506[s] | perplexity 138.49
| epoch 3 |  iter 981 / 1327 | time 509[s] | perplexity 129.78
| epoch 3 |  iter 1001 / 1327 | time 512[s] | perplexity 115.19
| epoch 3 |  iter 1021 / 1327 | time 514[s] | perplexity 136.60
| epoch 3 |  iter 1041 / 1327 | time 517[s] | perplexity 126.80
| epoch 3 |  iter 1061 / 1327 | time 520[s] | perplexity 109.36
| epoch 3 |  iter 1081 / 1327 | time 522[s] | perplexity 95.51
| epoch 3 |  iter 1101 / 1327 | time 525[s] | perplexity 102.93
| epoch 3 |  iter 1121 / 1327 | time 528[s] | perplexity 129.98
| epoch 3 |  iter 1141 / 1327 | time 530[s] | perplexity 121.62
| epoch 3 |  iter 1161 / 1327 | time 533[s] | perplexity 114.33
| epoch 3 |  iter 1181 / 1327 | time 536[s] | perplexity 118.83
| epoch 3 |  iter 1201 / 1327 | time 538[s] | perplexity 100.94
| epoch 3 |  iter 1221 / 1327 | time 541[s] | perplexity 95.83
| epoch 3 |  iter 1241 / 1327 | time 544[s] | perplexity 113.05
| epoch 3 |  iter 1261 / 1327 | time 547[s] | perplexity 110.35
| epoch 3 |  iter 1281 / 1327 | time 549[s] | perplexity 109.41
| epoch 3 |  iter 1301 / 1327 | time 552[s] | perplexity 139.37
| epoch 3 |  iter 1321 / 1327 | time 555[s] | perplexity 134.81
| epoch 4 |  iter 1 / 1327 | time 555[s] | perplexity 141.06
| epoch 4 |  iter 21 / 1327 | time 558[s] | perplexity 129.07
| epoch 4 |  iter 41 / 1327 | time 561[s] | perplexity 115.91
| epoch 4 |  iter 61 / 1327 | time 563[s] | perplexity 115.81
| epoch 4 |  iter 81 / 1327 | time 566[s] | perplexity 104.10
| epoch 4 |  iter 101 / 1327 | time 569[s] | perplexity 92.89
| epoch 4 |  iter 121 / 1327 | time 571[s] | perplexity 102.07
| epoch 4 |  iter 141 / 1327 | time 574[s] | perplexity 110.50
| epoch 4 |  iter 161 / 1327 | time 577[s] | perplexity 125.86
| epoch 4 |  iter 181 / 1327 | time 579[s] | perplexity 136.32
| epoch 4 |  iter 201 / 1327 | time 582[s] | perplexity 126.75
| epoch 4 |  iter 221 / 1327 | time 585[s] | perplexity 129.13
| epoch 4 |  iter 241 / 1327 | time 588[s] | perplexity 120.78
| epoch 4 |  iter 261 / 1327 | time 591[s] | perplexity 121.84
| epoch 4 |  iter 281 / 1327 | time 594[s] | perplexity 128.53
| epoch 4 |  iter 301 / 1327 | time 598[s] | perplexity 110.85
| epoch 4 |  iter 321 / 1327 | time 601[s] | perplexity 92.00
| epoch 4 |  iter 341 / 1327 | time 604[s] | perplexity 107.74
| epoch 4 |  iter 361 / 1327 | time 606[s] | perplexity 135.26
| epoch 4 |  iter 381 / 1327 | time 609[s] | perplexity 106.05
| epoch 4 |  iter 401 / 1327 | time 612[s] | perplexity 117.27
| epoch 4 |  iter 421 / 1327 | time 615[s] | perplexity 102.54
| epoch 4 |  iter 441 / 1327 | time 617[s] | perplexity 110.11
| epoch 4 |  iter 461 / 1327 | time 620[s] | perplexity 107.13
| epoch 4 |  iter 481 / 1327 | time 623[s] | perplexity 109.22
| epoch 4 |  iter 501 / 1327 | time 626[s] | perplexity 119.20
| epoch 4 |  iter 521 / 1327 | time 628[s] | perplexity 124.15
| epoch 4 |  iter 541 / 1327 | time 631[s] | perplexity 119.52
| epoch 4 |  iter 561 / 1327 | time 634[s] | perplexity 111.08
| epoch 4 |  iter 581 / 1327 | time 637[s] | perplexity 97.05
| epoch 4 |  iter 601 / 1327 | time 640[s] | perplexity 135.93
| epoch 4 |  iter 621 / 1327 | time 643[s] | perplexity 130.22
| epoch 4 |  iter 641 / 1327 | time 645[s] | perplexity 119.08
| epoch 4 |  iter 661 / 1327 | time 648[s] | perplexity 110.28
| epoch 4 |  iter 681 / 1327 | time 651[s] | perplexity 90.58
| epoch 4 |  iter 701 / 1327 | time 654[s] | perplexity 110.32
| epoch 4 |  iter 721 / 1327 | time 658[s] | perplexity 114.36
| epoch 4 |  iter 741 / 1327 | time 661[s] | perplexity 103.03
| epoch 4 |  iter 761 / 1327 | time 664[s] | perplexity 95.70
| epoch 4 |  iter 781 / 1327 | time 667[s] | perplexity 95.84
| epoch 4 |  iter 801 / 1327 | time 670[s] | perplexity 105.26
| epoch 4 |  iter 821 / 1327 | time 672[s] | perplexity 109.28
| epoch 4 |  iter 841 / 1327 | time 675[s] | perplexity 106.28
| epoch 4 |  iter 861 / 1327 | time 678[s] | perplexity 111.32
| epoch 4 |  iter 881 / 1327 | time 681[s] | perplexity 98.10
| epoch 4 |  iter 901 / 1327 | time 684[s] | perplexity 122.68
| epoch 4 |  iter 921 / 1327 | time 686[s] | perplexity 110.51
| epoch 4 |  iter 941 / 1327 | time 689[s] | perplexity 121.01
| epoch 4 |  iter 961 / 1327 | time 692[s] | perplexity 119.48
| epoch 4 |  iter 981 / 1327 | time 695[s] | perplexity 113.40
| epoch 4 |  iter 1001 / 1327 | time 697[s] | perplexity 103.34
| epoch 4 |  iter 1021 / 1327 | time 700[s] | perplexity 119.11
| epoch 4 |  iter 1041 / 1327 | time 703[s] | perplexity 111.88
| epoch 4 |  iter 1061 / 1327 | time 706[s] | perplexity 95.14
| epoch 4 |  iter 1081 / 1327 | time 709[s] | perplexity 85.43
| epoch 4 |  iter 1101 / 1327 | time 712[s] | perplexity 88.13
| epoch 4 |  iter 1121 / 1327 | time 714[s] | perplexity 111.29
| epoch 4 |  iter 1141 / 1327 | time 717[s] | perplexity 107.85
| epoch 4 |  iter 1161 / 1327 | time 720[s] | perplexity 99.91
| epoch 4 |  iter 1181 / 1327 | time 722[s] | perplexity 104.47
| epoch 4 |  iter 1201 / 1327 | time 725[s] | perplexity 90.15
| epoch 4 |  iter 1221 / 1327 | time 728[s] | perplexity 82.63
| epoch 4 |  iter 1241 / 1327 | time 731[s] | perplexity 99.07
| epoch 4 |  iter 1261 / 1327 | time 733[s] | perplexity 100.08
| epoch 4 |  iter 1281 / 1327 | time 736[s] | perplexity 97.07
| epoch 4 |  iter 1301 / 1327 | time 739[s] | perplexity 120.98
| epoch 4 |  iter 1321 / 1327 | time 741[s] | perplexity 119.07
libpng warning: iCCP: known incorrect sRGB profile
libpng warning: iCCP: known incorrect sRGB profile
evaluating perplexity ...
234 / 235
test perplexity:  142.47418

Process finished with exit code 0
